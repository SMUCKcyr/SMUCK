import { useState, useEffect, useRef } from "react";

export default function ChatPage() {
  const [messages, setMessages] = useState([
    {
      from: "bot",
      text: "Oi! Eu sou a SMUCK ðŸ¤–. Me mande uma mensagem como se fosse um cliente."
    }
  ]);
  const [input, setInput] = useState("");
  const boxRef = useRef(null);

  useEffect(() => {
    if (boxRef.current) {
      boxRef.current.scrollTop = boxRef.current.scrollHeight;
    }
  }, [messages]);

  function handleSend(event) {
    event.preventDefault();

    const text = input.trim();
    if (!text) return;

    setInput("");

    setMessages((prev) => [
      ...prev,
      { from: "user", text },
      {
        from: "bot",
        text:
          "Recebi sua mensagem ðŸ™Œ. Em breve este chat vai usar a IA real da SMUCK conectada aos documentos da sua empresa."
      }
    ]);
  }

  return (
    <div style={styles.page}>
      <div style={styles.card}>
        <h1 style={styles.title}>Chat de demonstraÃ§Ã£o da SMUCK</h1>
        <p style={styles.subtitle}>
          Use este chat como se fosse um cliente perguntando sobre produtos,
          horÃ¡rios ou suporte.
        </p>

        <div ref={boxRef} style={styles.messages}>
          {messages.map((m, index) => (
            <div
              key={index}
              style={{
                ...styles.message,
                ...(m.from === "user" ? styles.userMessage : styles.botMessage)
              }}
            >
              <span style={styles.messageLabel}>
                {m.from === "user" ? "VocÃª" : "SMUCK"}
              </span>
              <p style={styles.messageText}>{m.text}</p>
            </div>
          ))}
        </div>

        <form onSubmit={handleSend} style={styles.form}>
          <textarea
            value={input}
            onChange={(e) => setInput(e.target.value)}
            placeholder="Digite sua mensagem aqui..."
            rows={3}
            style={styles.input}
          />
          <button type="submit" style={styles.button}>
            Enviar
          </button>
        </form>

        <p style={styles.footer}>
          ðŸ”§ Esta Ã© uma versÃ£o demo. O prÃ³ximo passo Ã© conectar com a API de IA
          de verdade para responder usando os dados da empresa.
        </p>
      </div>
    </div>
  );
}

const styles = {
  page: {
    fontFamily: "Arial, sans-serif",
    background: "#f5f5f5",
    minHeight: "100vh",
    padding: "16px"
  },
  card: {
    background: "#ffffff",
    maxWidth: "900px",
    margin: "0 auto",
    borderRadius: "12px",
    boxShadow: "0 4px 12px rgba(0, 0, 0, 0.08)",
    padding: "16px 16px 12px"
  },
  title: {
    fontSize: "22px",
    margin: 0
  },
  subtitle: {
    marginTop: "8px",
    marginBottom: "12px",
    color: "#555",
    fontSize: "14px"
  },
  messages: {
    border: "1px solid #eee",
    borderRadius: "8px",
    padding: "8px",
    height: "320px",
    overflowY: "auto",
    background: "#fafafa",
    display: "flex",
    flexDirection: "column",
    gap: "6px",
    marginBottom: "12px"
  },
  message: {
    padding: "8px",
    borderRadius: "8px",
    maxWidth: "90%"
  },
  userMessage: {
    alignSelf: "flex-end",
    background: "#dcf8c6",
    textAlign: "right"
  },
  botMessage: {
    alignSelf: "flex-start",
    background: "#ffffff",
    border: "1px solid #eee"
  },
  messageLabel: {
    display: "block",
    fontSize: "11px",
    color: "#777",
    marginBottom: "2px"
  },
  messageText: {
    margin: 0,
    fontSize: "14px"
  },
  form: {
    display: "flex",
    flexDirection: "column",
    gap: "8px"
  },
  input: {
    borderRadius: "8px",
    border: "1px solid #ccc",
    padding: "8px",
    fontSize: "14px",
    resize: "vertical"
  },
  button: {
    borderRadius: "8px",
    border: "none",
    padding: "10px",
    fontSize: "15px",
    fontWeight: "bold",
    background: "#111",
    color: "#fff",
    cursor: "pointer"
  },
  footer: {
    marginTop: "10px",
    fontSize: "12px",
    color: "#777"
  }
};
